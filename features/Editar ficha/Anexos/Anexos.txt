# **Anexos:**

O que serÃ¡: CTA  que abrirÃ¡ um modal para que Analistas, Gestores e Vendedores possam fazer upload de arquivos (PDFs, imagens, documentos, planilhas) relacionados ao campo cujo Action foi chamada. 

Como chamar funÃ§Ã£o: Digitar â€œ/Anexoâ€ nos campos de digitaÃ§Ã£o cujo CTA estÃ¡ ativo.
- Campos nos quais colocaremos CTA para ser ativo (Ser chamado) : 

    - Aba â€œEditar Fichaâ€: Campos de parecer e Conversas co-relacionadas, seja o campo principal ou respostas e Sub-respostas dos mesmos
    - **Expanded Ficha: Campo de parecer,** seja o campo principal ou respostas e Sub-respostas dos mesmos 

### **O que abre:**

- Abre umÂ **modal de upload**Â centralizado na tela
    
    ## Features para criar no Modal:
    
    ### **1. Upload de Arquivos**
    
    - âœ… SeleÃ§Ã£o de arquivos porÂ **clique**Â no botÃ£o
    - âœ…Â **Drag & Drop**Â (arrastar e soltar) diretamente na Ã¡rea
    - âœ… Upload deÂ **mÃºltiplos arquivos**Â simultaneamente
    - âœ… Adicionar maisÂ arquivos apÃ³s a seleÃ§Ã£o inicial
    
    ### **2. ValidaÃ§Ãµes AutomÃ¡ticas**
    
    - âœ…Â **Tamanho mÃ¡ximo**: 10MB por arquivo
    - Rejeita arquivos maiores com alerta
    - âœ…Â **TiposÂ permitidos**:
    - Imagens: JPG, JPEG, PNG, GIF, WEBP, HEIC, HEIF
    - Documentos: PDF
    - Office: DOC, DOCX, XLS, XLSX
    - Texto: TXT
    - Compactados: ZIP, RAR
    - âœ…Â **Duplicatas**: Detecta e impede upload de arquivo jÃ¡Â selecionado
    
    ### **3. PersonalizaÃ§Ã£o de Arquivos**
    
    - âœ…Â **Nome personalizado obrigatÃ³rio**Â para cada arquivo
    - Placeholder sugestivo: "Ex: CNHÂ do titular, Comprovante de renda"
    - âœ…Â **DescriÃ§Ã£o opcional**Â compartilhada para todosÂ os arquivos
    - Textarea com 3 linhas
    - PlaceholderÂ com exemplo real de uso
    - Aceita informaÃ§Ãµes contextuais
    
    ### **4. Gerenciamento Visual**
    
    - âœ…Â **Ãcones por tipo de arquivo**:
    - ğŸ“„ PDF
    - ğŸ–¼ï¸ Imagens
    - ğŸ“Š Excel
    - ğŸ“ Word
    - ğŸ“¦Â Compactados
    - âœ…Â **Tamanho formatado**: Exibe tamanho emÂ MB/KB (ex: "2.5Â MB")
    - âœ…Â **Remover arquivos individuais**: BotÃ£o [X] em cada card
    - âœ…Â **ListaÂ organizada**: Cards empilhados verticalmente
    
    ### **5. Feedback Visual emÂ Tempo Real**
    
    - âœ…Â **Indicador deÂ Drag Over**: Borda verde eÂ fundo claro quando arrasta arquivo
    - âœ…Â **Alerta de validaÃ§Ã£o**:
    - âš ï¸ BannerÂ amarelo quando falta nome
    - âœ… Banner verde quando tudo estÃ¡ OK
    - âœ…Â **Loading State**: Spinner e textoÂ "Enviando..." durante upload
    - âœ…Â **Desabilita botÃµes**Â durante processoÂ de upload
    
    ### **6. ConfirmaÃ§Ã£o de SaÃ­da**
    
    - âœ…Â **Modal de confirmaÃ§Ã£o**Â ao tentar fechar com alteraÃ§Ãµes nÃ£o salvas
    - OpÃ§Ãµes: "Cancelar",Â "Sair sem Salvar", "Salvar e Sair"
    - âœ…Â **DetecÃ§Ã£o automÃ¡tica**Â de mudanÃ§asÂ (arquivo adicionado, nome alterado)
    
    ### **7. Upload Inteligente**
    
    - âœ…Â **Upload sequencial**: Processa arquivos um por um
    - âœ…Â **Aguarda processamento**: Delay de 700ms antesÂ de fechar o modal
    - âœ…Â **Reset automÃ¡tico**: Limpa formulÃ¡rio apÃ³s upload bem-sucedido
    - âœ…Â **FechaÂ automaticamente**Â apÃ³s conclusÃ£o
    
    ### **8. OrganizaÃ§Ã£o no Storage**
    
    - âœ…Â **Path estruturado**:Â card_id/nome_arquivo_2025-01-15_abc123.pdf
    - âœ…Â **Timestamp Ãºnico**: Evita conflito de nomes
    - âœ…Â **SanitizaÃ§Ã£o**: Remove caracteres especiais do nome
    - âœ…Â **ExtensÃ£o preservada**: MantÃ©m tipoÂ original do arquivo
    
    ### **9. Metadados Salvos**
    
    - âœ… Salva automaticamente:
    - Nome personalizado
    - DescriÃ§Ã£oÂ (se fornecida)
    - Autor (ID, nome, funÃ§Ã£o)
    - Caminho no Storage
    - Tamanho, tipo MIME, extensÃ£o
    - Data/hora de criaÃ§Ã£o
    
    ### **10. Acessibilidade**
    
    - âœ…Â **Input file oculto**: Interface customizada maisÂ amigÃ¡vel
    - âœ…Â **Tooltips descritivos**Â em todos os botÃµes
    - âœ…Â **ARIA labels**Â nosÂ elementos principais
    - âœ…Â **MÃºltiplas formas de seleÃ§Ã£o**: Clique, drag & drop, botÃ£o adicionar
    

<aside>
ğŸ’¡

Estrutura do Modal: 

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ”¼ HEADER (Gradiente Verde #018942)                         [X] â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚  [ğŸ“¤]  Anexar Arquivo                                      â”‚  â•‘
â•‘  â”‚        Envie documentos e imagens para a ficha             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                   â•‘
â•‘  ğŸ”¹ SEÃ‡ÃƒO 1: ARQUIVOS                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â•‘
â•‘  â”‚ â”‚  [ÃREA DE DRAG & DROP - Borda Tracejada]          â”‚   â”‚   â•‘
â•‘  â”‚ â”‚                                                    â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                                          â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  â”‚ ğŸ“¤  â”‚  (Ãcone Grande de Upload)                â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”˜                                          â”‚   â”‚   â•‘
â•‘  â”‚ â”‚                                                    â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  Arraste um arquivo aqui ou [clique para          â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  selecionar]                                      â”‚   â”‚   â•‘
â•‘  â”‚ â”‚                                                    â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  â— MÃ¡ximo: 10MB por arquivo                       â”‚   â”‚   â•‘
â•‘  â”‚ â”‚  â— Tipos: Imagens, PDF, Documentos, Planilhas     â”‚   â”‚   â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                   â•‘
â•‘  â”Œâ”€â”€â”€ QUANDO ARQUIVO(S) SELECIONADO(S) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘  â”‚                                                         â”‚     â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â•‘
â•‘  â”‚  â”‚ [ğŸ“„] contrato.pdf                        [X]  â”‚     â”‚     â•‘
â•‘  â”‚  â”‚      â— 2.5 MB                                 â”‚     â”‚     â•‘
â•‘  â”‚  â”‚                                               â”‚     â”‚     â•‘
â•‘  â”‚  â”‚  Nome do documento (obrigatÃ³rio):            â”‚     â”‚     â•‘
â•‘  â”‚  â”‚  [Contrato de AdesÃ£o                    ]    â”‚     â”‚     â•‘
â•‘  â”‚  â”‚   â””â”€> Input de texto                         â”‚     â”‚     â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â•‘
â•‘  â”‚                                                         â”‚     â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â•‘
â•‘  â”‚  â”‚ [ğŸ–¼ï¸] foto-rg.jpg                         [X]  â”‚     â”‚     â•‘
â•‘  â”‚  â”‚      â— 1.2 MB                                 â”‚     â”‚     â•‘
â•‘  â”‚  â”‚                                               â”‚     â”‚     â•‘
â•‘  â”‚  â”‚  Nome do documento (obrigatÃ³rio):            â”‚     â”‚     â•‘
â•‘  â”‚  â”‚  [RG do Titular                         ]    â”‚     â”‚     â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â•‘
â•‘  â”‚                                                         â”‚     â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚     â•‘
â•‘  â”‚  â”‚  [ğŸ“¤] Adicionar Outro Arquivo               â”‚       â”‚     â•‘
â•‘  â”‚  â”‚  â””â”€> BotÃ£o tracejado verde                  â”‚       â”‚     â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                   â•‘
â•‘  ğŸ”¹ SEÃ‡ÃƒO 2: DESCRIÃ‡ÃƒO                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚  ObservaÃ§Ãµes (opcional):                                 â”‚   â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â•‘
â•‘  â”‚  â”‚ Ex: Enviou CNH consta CPF + Comprovante...       â”‚  â”‚   â•‘
â•‘  â”‚  â”‚                                                  â”‚  â”‚   â•‘
â•‘  â”‚  â”‚                                                  â”‚  â”‚   â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â•‘
â•‘  â”‚  Adicione informaÃ§Ãµes contextuais sobre os documentos    â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                   â•‘
â•‘  ğŸ”¹ VALIDAÃ‡ÃƒO (Condicional)                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚  âš ï¸  AtenÃ§Ã£o!                                            â”‚   â•‘
â•‘  â”‚     Por favor, dÃª um nome para todos os arquivos         â”‚   â•‘
â•‘  â”‚     antes de enviar.                                     â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘           OU (quando tudo OK)                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚  âœ…  Tudo pronto!                                         â”‚   â•‘
â•‘  â”‚     Todos os arquivos tÃªm nomes definidos e podem        â”‚   â•‘
â•‘  â”‚     ser enviados.                                        â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                   â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘                                                                   â•‘
â•‘  AÃ‡Ã•ES (RodapÃ©)                                                  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚  Cancelar   â”‚  â”‚  [ğŸ“¤] Enviar Arquivos        â”‚             â•‘
â•‘  â”‚  (Cinza)    â”‚  â”‚  (Verde com gradiente)       â”‚             â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•‘                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

</aside>

**Ao confirmar (Upload):**

- **Valida o arquivo:**
- Tamanho mÃ¡ximo:Â **10MB por arquivo**
- Tipos permitidos:Â **Imagens (JPG, PNG, GIF), PDF, Documentos (DOC, DOCX), Planilhas (XLS, XLSX), TXT, ZIP, RAR**
- **Exibe notificaÃ§Ã£o deÂ sucesso**Â ("Arquivo enviado com sucesso!")
- **Aparece na listaÂ de anexos**Â com Ã­cone do tipoÂ de arquivo, nome, tamanho, autor e data
- **Faz upload para o Storage**Â (card-attachments/[card_id]/[arquivo])
- **Salva metadados noÂ banco**Â (tabelaÂ card_attachments)
- **Atualiza em tempo real**Â paraÂ quem estiver com a ficha aberta

<aside>
ğŸ’¡

**Hook Realtime deÂ salvamento:**

**ArquivoÂ FÃ­sico**Â â€”Hookâ€”>Â **Supabase Storage**Â (card-attachmentsÂ bucket)

**Metadados**Â â€”Hookâ€”>Â **public.card_attachments**Â (tabela)

- **OÂ que fica salvo (porÂ anexo):**
- **id**: identificador Ãºnico do anexo (UUID)
- **card_id**: ID da ficha vinculada
- **author_id,Â author_name,Â author_role**: quem enviou
- **file_name**: nome personalizado dado pelo usuÃ¡rio
- **file_path**: caminho no Storage (card_id/arquivo.pdf)
- **file_size**: tamanhoÂ em bytes
- **file_type**: tipo MIME (application/pdf,Â image/jpeg, etc.)
- **file_extension**: extensÃ£o (pdf,Â jpg,Â docx, etc.)
- **description**: descriÃ§Ã£o opcional
- **comment_id**: (opcional) vincula a um comentÃ¡rio/parecer especÃ­fico
- **created_at**: data/hora de criaÃ§Ã£o
- **updated_at**: data/hora daÂ Ãºltima atualizaÃ§Ã£o
- **Soft-delete**Â (se usado):Â deleted_at,Â deleted_by
- **Resultado:**Â Quando hÃ¡Â 2+ anexos, todosÂ permanecem na lista. OÂ sistema apenas adiciona o novo comoÂ mais um item. Em caso de exclusÃ£o, marcaÂ como deletado (soft-delete) ou remove permanentemente dependendo da configuraÃ§Ã£o.
</aside>

# **ApÃ³s: â€œEnviar arquivosâ€ Como esse campo deve aparecer no Front (UI):**

## **1 - Features do Campo Visual**

1.1 **PrÃ©-visualizaÃ§Ã£oÂ (Modal):** 

- âœ…Â **Abertura por clique**: NoÂ botÃ£o de tipo
- âœ…Â **ModalÂ fullscreen**: Largura mÃ¡ximaÂ 4xl
- âœ…Â **HeaderÂ informativo**: Nome do arquivo + Ã­coneÂ ğŸ‘ï¸
- âœ…Â **Visualizador de PDF**: Embedded comÂ <object>
- âœ…Â **Fallback para imagens**: Preview de imagens
- âœ…Â **LoadingÂ state**: Spinner durante carregamento
- âœ…Â **Mensagem de erro**: SeÂ falhar o carregamento
- âœ…Â **BotÃ£o "Tentar novamente" (cor cinza)**: Em casoÂ de erro
- âœ…Â **AlturaÂ controlada**: 70vh paraÂ o preview
- âœ…Â **BotÃ£o fechar**: [X] no header
- âœ…Â **BotÃ£o baixar**: No rodapÃ© do modal
- âœ…Â **ESC para fechar**:Â Atalho de teclado

### **1.2 Download**

- âœ…Â **Clique no botÃ£oÂ â†—ï¸**: Abre em novaÂ aba
- âœ…Â **Busca recursiva**: ListaÂ todos os arquivos do storage
- âœ…Â **MatchÂ por nome**: Compara nomes sanitizados
- âœ…Â **Mensagem de erro**: Toast se falhar
- âœ…Â **Log no console**: Para debug

### 1.3 **ExclusÃ£o:**

- âœ…Â **MenuÂ dropdown**: Clique nos trÃªsÂ pontos
- âœ…Â **OpÃ§Ã£o vermelha**:Â "ğŸ—‘ï¸ Excluir anexo"
- âœ…Â **Modal de confirmaÃ§Ã£o**: AntesÂ de excluir
- âœ…Â **TÃ­tuloÂ do modal**:Â "âš ï¸ Confirmar ExclusÃ£o"
- âœ…Â **Mensagem clara**: Mostra nome do arquivo
- âœ…Â **Aviso de irreversibilidade**: "Esta aÃ§Ã£o nÃ£o pode ser desfeita"
- âœ…Â **BotÃ£oÂ Cancelar**: Cinza, cancela a aÃ§Ã£o
- âœ…Â **BotÃ£o Excluir**: Vermelho, confirma exclusÃ£o
- âœ…Â **Loading state**: Spinner durante exclusÃ£o
- âœ…Â **FeedbackÂ visual**: Toast de sucesso/erro

## **2. Quando Ã© chamado /Anexo dentro de um Campo de parecer:**

**VisualizaÃ§Ã£o/Preview (Campo visual) dentro de um campo parecer, como se fosse criado uma resposta mesmo:** 

**Desenho do Campo Visual:** 

<aside>
ğŸ’¡

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“„ PDF] [Nome do Arquivo]              [â†—ï¸] [Lixeira (Excluir]      â”‚
â”‚          [hÃ¡ X tempo]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

</aside>

**LAYOUT GERAL:** 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€”                                                                                                                                                                                    | 
â”‚ [BotÃ£o Tipo] [Nome + Info]                               [â†—ï¸]   [â‹®]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–²                          â–²                                                      â–²    â–²
â”‚                           â”‚                                                       â”‚    â”‚
Ãcone             ConteÃºdo                                 Baixar Menu

Menu: 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ï¸ Excluir anexo          â”‚  â† OpÃ§Ã£o vermelha   |
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<aside>
ğŸ’¡

Segue confirmaÃ§Ã£o de exclusÃ£o descrita acima em Campo visual (Features) / ExclusÃ£o: 

- âœ…Â **Modal de confirmaÃ§Ã£o**: AntesÂ de excluir
- âœ…Â **TÃ­tuloÂ do modal**:Â "âš ï¸ Confirmar ExclusÃ£o"
- âœ…Â **Mensagem clara**: Mostra nome do arquivo
- âœ…Â **Aviso de irreversibilidade**: "Esta aÃ§Ã£o nÃ£o pode ser desfeita"
- âœ…Â **BotÃ£oÂ Cancelar**: Cinza, cancela a aÃ§Ã£o
- âœ…Â **BotÃ£o Excluir**: Vermelho, confirma exclusÃ£o
- âœ…Â **Loading state**: Spinner durante exclusÃ£o
- âœ…Â **FeedbackÂ visual**: Toast de sucesso/erro
</aside>

## **3. Quando chamado /Anexo dentro de um Campo de Conversa Co-relacionada (Trheads ou ComentÃ¡rio:**

**VisualizaÃ§Ã£o/Preview (Campo visual) dentro de um campo de conversa co-relacionada, seja uma trhead ou um comentÃ¡rio (Resposta / Subresosta, como se fosse criado uma resposta mesmo:** 

**Desenho do Campo Visual:** 

<aside>
ğŸ’¡

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“„ PDF] [Nome do Arquivo]              [â†—ï¸] [Lixeira (Excluir]      â”‚
â”‚          [hÃ¡ X tempo]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

</aside>

**LAYOUT GERAL:** 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â€”                                                                                                                                                                                   | 
â”‚ [BotÃ£o Tipo] [Nome + Info]                               [â†—ï¸]   [â‹®]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–²                          â–²                                                      â–²    â–²
â”‚                           â”‚                                                       â”‚    â”‚
Ãcone             ConteÃºdo                                 Baixar Menu

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ï¸ Excluir anexo          â”‚  â† OpÃ§Ã£o vermelha
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<aside>
ğŸ’¡

Segue confirmaÃ§Ã£o de exclusÃ£o descrita acima em Campo visual (Features) / ExclusÃ£o: 

- âœ…Â **Modal de confirmaÃ§Ã£o**: AntesÂ de excluir
- âœ…Â **TÃ­tuloÂ do modal**:Â "âš ï¸ Confirmar ExclusÃ£o"
- âœ…Â **Mensagem clara**: Mostra nome do arquivo
- âœ…Â **Aviso de irreversibilidade**: "Esta aÃ§Ã£o nÃ£o pode ser desfeita"
- âœ…Â **BotÃ£oÂ Cancelar**: Cinza, cancela a aÃ§Ã£o
- âœ…Â **BotÃ£o Excluir**: Vermelho, confirma exclusÃ£o
- âœ…Â **Loading state**: Spinner durante exclusÃ£o
- âœ…Â **FeedbackÂ visual**: Toast de sucesso/erro
</aside>